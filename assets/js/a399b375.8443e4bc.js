"use strict";(self.webpackChunkstylable_io=self.webpackChunkstylable_io||[]).push([[2919],{1369:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var n=s(5893),i=s(1151);const r={id:"typescript-integration",title:"TypeScript"},l=void 0,o={id:"getting-started/typescript-integration",title:"TypeScript",description:"Whenever a TypeScript file imports a Stylable stylesheet, you must provide a type for it. This is because TypeScript has no way of knowing what's inside Stylable *.st.css files.",source:"@site/docs/getting-started/typescript-integration.md",sourceDirName:"getting-started",slug:"/getting-started/typescript-integration",permalink:"/docs/getting-started/typescript-integration",draft:!1,unlisted:!1,editUrl:"https://github.com/wixplosives/stylable.io/edit/master/docs/getting-started/typescript-integration.md",tags:[],version:"current",frontMatter:{id:"typescript-integration",title:"TypeScript"},sidebar:"Discover",previous:{title:"Storybook",permalink:"/docs/getting-started/storybook-integration"},next:{title:"Webpack",permalink:"/docs/getting-started/webpack-integration"}},a={},c=[{value:"Generating types per stylesheet",id:"generating-types-per-stylesheet",level:2},{value:"Generated files",id:"generated-files",level:3},{value:"Using the CLI",id:"using-the-cli",level:3},{value:"Using a bundler",id:"using-a-bundler",level:3},{value:"Global definition",id:"global-definition",level:2},{value:"Typing 3rd-party stylesheets",id:"typing-3rd-party-stylesheets",level:3},{value:"Publishing",id:"publishing",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:["Whenever a TypeScript file imports a Stylable stylesheet, you must provide a type for it. This is because TypeScript has no way of knowing what's inside Stylable ",(0,n.jsx)(t.code,{children:"*.st.css"})," files."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="Import example"',children:"import { classes } from './button.st.css'; // requires typings\n"})}),"\n",(0,n.jsx)(t.h2,{id:"generating-types-per-stylesheet",children:"Generating types per stylesheet"}),"\n",(0,n.jsxs)(t.p,{children:["Stylable can generate a declaration file for each stylesheet. This approach has the advantage of providing exact typing information for each individual ",(0,n.jsx)(t.a,{href:"/docs/references/runtime",children:"stylesheet runtime API"}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"generated-files",children:"Generated files"}),"\n",(0,n.jsx)(t.p,{children:"Stylable generates two kinds of type-related files:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"*.d.ts"})," provides typing for the stylesheet runtime API."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"*.d.ts.map"})," provides mapping from the generated ",(0,n.jsx)(t.code,{children:".d.ts"})," file to the original ",(0,n.jsx)(t.code,{children:".st.css"})," stylesheet. This allows jumping to definitions in the original source straight from the TypeScript file."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Type definitions that are generated adjacent to the stylesheet are automatically detected and used by TypeScript. This can cause bloat in the project source files, however. To prevent clutter in your project, we recommend that you generate all stylesheet typings to a single directory."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"/* type files grouped in st-types folder */\n \u251c\u2500\u2500 src\n |  \u251c\u2500\u2500 button.st.css           - source stylesheet\n |  \u2514\u2500\u2500 button.tsx              - component file\n |\n \u2514\u2500\u2500 st-types\n    \u251c\u2500\u2500 button.st.css.d.ts      - type definition\n    \u2514\u2500\u2500 button.st.css.d.ts.map  - type definition source-map\n"})}),"\n",(0,n.jsxs)(t.p,{children:["You'll then need to configure TypeScript to use that directory. To do this, modify your ",(0,n.jsx)(t.code,{children:"tsconfig.json"})," to specify two ",(0,n.jsx)(t.code,{children:"rootDirs"})," - your source files, and the generated typings (learn more about this by reading the ",(0,n.jsxs)(t.a,{href:"https://www.typescriptlang.org/tsconfig#rootDirs",children:[(0,n.jsx)(t.code,{children:"tsconfig.json"})," documentation"]}),") like this:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-jsonc",metastring:'title="tsconfig.json"',children:'{\n  "compilerOptions": {\n    "rootDirs": ["./src", "./st-types"]\n  }\n}\n'})}),"\n",(0,n.jsx)(t.admonition,{type:"tip",children:(0,n.jsxs)(t.p,{children:["We recommend adding the generated ",(0,n.jsx)(t.code,{children:"*.st.css.d.ts"})," and ",(0,n.jsx)(t.code,{children:"*.st.css.d.ts.map"})," files to your ",(0,n.jsx)(t.code,{children:".gitignore"})," file, and to only include them in your published packages."]})}),"\n",(0,n.jsx)(t.h3,{id:"using-the-cli",children:"Using the CLI"}),"\n",(0,n.jsxs)(t.p,{children:["To generate type definition files to the ",(0,n.jsx)(t.code,{children:"st-types"})," directory using the ",(0,n.jsxs)(t.a,{href:"https://github.com/wix/stylable/tree/master/packages/cli#cli-arguments",children:[(0,n.jsx)(t.code,{children:"stc"})," CLI"]}),", provide it with the ",(0,n.jsx)(t.code,{children:"--srcDir"}),", ",(0,n.jsx)(t.code,{children:"--outDir"})," and ",(0,n.jsx)(t.code,{children:"--dts"})," flags:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:'stc --srcDir="src" --outDir="st-types" --dts\n'})}),"\n",(0,n.jsxs)(t.p,{children:["Source maps are generated by default when generating ",(0,n.jsx)(t.code,{children:".d.ts"})," files. If these are not wanted, the ",(0,n.jsx)(t.code,{children:"--dtsSourceMap"})," flag should be set to ",(0,n.jsx)(t.code,{children:"false"}),"."]}),"\n",(0,n.jsx)(t.admonition,{type:"tip",children:(0,n.jsxs)(t.p,{children:["Use ",(0,n.jsx)(t.a,{href:"https://github.com/wix/stylable/tree/master/packages/cli#configuration-file",children:(0,n.jsx)(t.code,{children:"stylable.config.js"})})," as a central location to share common Stylable configurations across tools and integrations."]})}),"\n",(0,n.jsx)(t.h3,{id:"using-a-bundler",children:"Using a bundler"}),"\n",(0,n.jsxs)(t.p,{children:["For projects that are already using one of our bundler integrations (",(0,n.jsx)(t.a,{href:"./webpack-integration",children:"webpack"})," or ",(0,n.jsx)(t.a,{href:"./rollup-integration",children:"rollup"}),"), you can configure the Stylable plugin to auto-generate types per stylesheet. This means that as you are working in your normal development flows, types will be updated in the background, and be available in your IDE."]}),"\n",(0,n.jsxs)(t.p,{children:["This functionality is dependant on a ",(0,n.jsx)(t.a,{href:"https://github.com/wix/stylable/tree/master/packages/cli#configuration-file",children:(0,n.jsx)(t.code,{children:"stylable.config.js"})})," file that includes configuration for generating ",(0,n.jsx)(t.code,{children:".d.ts"})," files."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-js",metastring:'title="stylable.config.js"',children:"//@ts-check\nconst { typedConfiguration } = require('@stylable/cli');\n\nexports.stcConfig = typedConfiguration({\n  options: {\n    srcDir: './src',\n    outDir: './st-types',\n    dts: true,\n  },\n});\n"})}),"\n",(0,n.jsxs)(t.p,{children:["To activate this functionality in the bundler, configure the Stylable plugin with ",(0,n.jsx)(t.code,{children:"{ stcConfig: true }"}),"."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-js",children:"// create a webpack plugin instance\nnew StylableWebpackPlugin({ stcConfig: true });\n\n// create a rollup plugin instance\nstylableRollupPlugin({ stcConfig: true });\n"})}),"\n",(0,n.jsx)(t.h2,{id:"global-definition",children:"Global definition"}),"\n",(0,n.jsxs)(t.p,{children:["If you choose not to generate ",(0,n.jsx)(t.code,{children:".d.ts"})," typings for each stylesheet, you'll have to include in your project a general purpose ",(0,n.jsx)(t.code,{children:"*.st.css"})," global declaration. This provides a broad signature of a Stylable stylesheet."]}),"\n",(0,n.jsxs)(t.p,{children:["To do this, create a ",(0,n.jsx)(t.code,{children:"globals.d.ts"})," file in your ",(0,n.jsx)(t.code,{children:"./src"})," directory and add the following declaration:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="globals.d.ts"',children:"declare module '*.st.css' {\n  export * from '@stylable/runtime/stylesheet';\n\n  const defaultExport: unknown;\n  export default defaultExport;\n}\n"})}),"\n",(0,n.jsx)(t.h3,{id:"typing-3rd-party-stylesheets",children:"Typing 3rd-party stylesheets"}),"\n",(0,n.jsxs)(t.p,{children:["If your project generates ",(0,n.jsx)(t.code,{children:".d.ts"})," typings for each stylesheet but you're consuming a package that published ",(0,n.jsx)(t.code,{children:".st.css"})," files without typings, you will have to declare global typings for that specific package."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="globals.d.ts"',children:"declare module 'third-party-package/*.st.css' {\n  export * from '@stylable/runtime/stylesheet';\n\n  const defaultExport: unknown;\n  export default defaultExport;\n}\n"})}),"\n",(0,n.jsx)(t.h2,{id:"publishing",children:"Publishing"}),"\n",(0,n.jsxs)(t.p,{children:["If you publish any ",(0,n.jsx)(t.code,{children:"*.st.css"})," files in your package, you should also publish the ",(0,n.jsx)(t.code,{children:".d.ts"})," and ",(0,n.jsx)(t.code,{children:".d.ts.map"})," files adjacent to them. This practice leads to a better experience for users consuming your project."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:'stc --srcDir="src" --outDir="dist" --stcss --dts\n'})})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,t,s)=>{s.d(t,{Z:()=>o,a:()=>l});var n=s(7294);const i={},r=n.createContext(i);function l(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);